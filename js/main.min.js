"use strict";function n(){fn=$(".lag-panel"),vn=$(".warn-panel"),gn="true"==P("low")||W(),k(),gn||(fn.addClass("active"),$(".lag-panel > .close").click(function(){fn.hide()}),$(".lag-panel > .lag-btn").click(function(){t()})),yn=gn?1e3:1300}function t(){var n=window.location.href;n.indexOf("?")>-1?n+="&low=true":n+="?low=true",window.location.href=n}function o(){var n;s(),S=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,gn?4e3:9500),l(),c(),kn.console=i("console",700,200,0,0,-5e3,0,0,0),n=x(0,ln,850,-52),kn.contentPanel=i("content-panel",600,550,n[0],20,n[1],0,y(-38),0),kn.panelPoint=new THREE.Object3D,n=x(0,ln,800,-65),kn.panelPoint.position.set(n[0],0,n[1]),kn.videoPanel=i("video-panel",850,400,0,0,cn+1e3,0,0,0),kn.about=i("about",127,127,0,0,cn,0,0,0),kn.projects=i("projects",73,73,0,0,0,0,0,0),kn.skills=i("skills",73,73,0,0,0,0,0,0),kn.contact=i("contact",73,73,0,0,0,0,0,0),document.addEventListener("mousemove",v,!1),window.addEventListener("resize",T,!1),setInterval(function(){H()},600),S.position.x=0,S.position.y=5e3,S.position.z=1e3,D=kn.console.position,S.lookAt(D),e()}function e(){var n,t;if(requestAnimationFrame(e),TWEEN.update(),r(),!En&&on){if(!gn){for(G.rotation.z+=rn.var,F.rotation.z+=rn.var,n=0;n<F.children.length;n++)t=F.children[n],t.rotation.z+=sn,t.rotation.y+=sn;for(n=0;n<O.children.length;n++)O.children[n].rotation.y-=rn.var;A.rotation.z+=rn.var}if(on)for(n=0;n<X.length;n++)t=X[n],t.isContentActive||(t.currentAngle+=-rn.var*t.rotFactor,t.position.x=t.rotationRadius*Math.cos(t.currentAngle),t.position.y=t.rotationRadius*Math.sin(t.currentAngle)),t.rotation.z+=sn,t.rotation.y+=sn}En||(I.render(j,S),N.render(L,S))}function i(n,t,o,e,i,a,r,s,c){var l=$("#"+n),d=M(l[0].outerHTML,t,o);return l.remove(),d.position.set(e,i,a),d.rotation.set(r,s,c),L.add(d),d}function a(){new TWEEN.Tween(S.position).to({x:0,y:0,z:-4400},1e3).easing(TWEEN.Easing.Cubic.Out).start().onComplete(function(){tn.tryToType("Loading...",!1,function(){m()})})}function r(){gn||(S.position.x+=.04*(Q/2-S.position.x),S.position.y+=.04*(-U/2-S.position.y)),S.lookAt(D)}function s(){j=new THREE.Scene,gn||(j.fog=new THREE.Fog(7,2500,1e4)),I=new THREE.WebGLRenderer,I.setClearColor(7),I.setPixelRatio(window.devicePixelRatio),I.setSize(window.innerWidth,window.innerHeight),$(I.domElement).appendTo(document.body)}function c(){L=new THREE.Scene,N=new THREE.CSS3DRenderer,N.setSize(window.innerWidth,window.innerHeight),N.domElement.style.position="absolute",N.domElement.style.top=0,$(N.domElement).appendTo(document.body)}function l(){var n=new THREE.AmbientLight(16777215,.02);n.name="ambientLight",j.add(n);var t=new THREE.DirectionalLight(8575475,.05);t.position.set(-1,1,1).normalize(),t.name="dirLight",j.add(t),gn||(d(-700,-500,5500),d(700,500,5500)),d(-500,200,8500)}function d(n,t,o){var e=new THREE.PointLight(1817577,1.3,2e3);e.position.set(n,t,o),j.add(e)}function p(){I.render(j,S),N.render(L,S);var n=$(".tablinks"),t=$(".video-ctn"),o=$(".menu-item");tn=new Mn,tn.captionEl=$("#caption"),hn=$("#iframe-video")[0],$("#video-panel > button").click(function(){pn&&h()}),wn=n.length-1,n.click(function(){var n=$(this);R(parseInt(n[0].id.slice(-1)))}),t.click(function(){var n=$(this);dn&&g(n.data("url"))}),o.click(function(){var n=$(this);dn&&E(parseInt(n.data("index")))})}function u(){G=new THREE.Object3D,F=new THREE.Object3D;var n,t,o,e,i,a,r,s=new THREE.Vector3,c=new THREE.BoxGeometry(J,J,J),l=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:50});if(!gn){for(n=0;n<150;n++)if(i=x(0,0,700+1e3*Math.random(),360*Math.random()),s.x=i[0],s.y=i[1],s.z=4500+3800*Math.random(),C(s))n--;else{if(nn>5e3)break;Y.push(s.clone()),t=new THREE.Mesh(c,l),t.position.copy(s),t.rotation.x=Math.random()*Math.PI,t.rotation.y=Math.random()*Math.PI,t.rotation.z=Math.random()*Math.PI,t.updateMatrix(),F.add(t)}for(n=0;n<500;n++)if(i=x(0,0,3700*Math.random(),360*Math.random()),s.x=i[0],s.y=i[1],s.z=6e3*Math.random(),C(s))n--;else{if(nn>5e3)break;Y.push(s.clone()),t=new THREE.Mesh(c,l),t.position.copy(s),t.rotation.x=Math.random()*Math.PI,t.rotation.y=Math.random()*Math.PI,t.rotation.z=Math.random()*Math.PI,t.updateMatrix(),t.matrixAutoUpdate=!1,G.add(t)}j.add(G),j.add(F)}for(c=new THREE.BoxGeometry(1.5*J,1.5*J,1.5*J,7,7,7),n=0;n<4;n++)e=Tn.splice(Math.floor(Math.random()*Tn.length),1)[0],a=360*Math.random(),r=700+1500*Math.random(),i=x(0,0,r,a),s.x=i[0],s.y=i[1],s.z=3e3+3300*Math.random(),t=new THREE.Mesh(c,new THREE.MeshBasicMaterial({color:e,wireframe:!0})),t.material.color.setHex(e),t.position.copy(s),t.rotationRadius=r,t.currentAngle=y(a),t.rotFactor=.5+1.5*Math.random(),t.lastPos=new THREE.Vector3,t.lastPos.copy(t.position),t.isContentActive=!1,t.rotation.x=Math.random()*Math.PI,t.rotation.y=Math.random()*Math.PI,t.rotation.z=Math.random()*Math.PI,X.push(t),o=new THREE.PointLight(e,2,1300),j.add(t),t.add(o)}function m(){var n=new THREE.LoadingManager;n.onProgress=function(n,t,o){console.log(n,t,o)};var t=function(n){if(n.lengthComputable){var t=n.loaded/n.total*100;console.log(Math.round(t,2)+"% downloaded")}},o=function(n){console.log("gg - failed to load obj")};new THREE.OBJLoader(n).load("models/Gear.obj",function(n){A=new THREE.Object3D,A.position.z=cn,B=n,B.scale.set(100,100,100),B.rotation.x=y(90),B.traverse(function(n){n instanceof THREE.Mesh&&(q=n,q.material=new THREE.MeshStandardMaterial({color:16777215,metalness:1,roughness:.5}),V=q.material)}),A.add(B),w(200,[-25,50,135],[-3,0,15]),j.add(A),u(),f()},t,o)}function w(n,t,o){var e,i;for(O=new THREE.Object3D,e=0;e<3;e++)i=B.clone(),i.position.x=n*Math.cos(y(t[e])),i.position.y=n*Math.sin(y(t[e])),i.rotation.y=y(o[e]),i.position.z=cn,i.scale.set(60,60,60),O.add(i);kn.projects.position.copy(O.children[0].position),kn.skills.position.copy(O.children[1].position),kn.contact.position.copy(O.children[2].position),j.add(O)}function h(){pn=!1;var n=new THREE.Vector3;n.copy(D),D=n,new TWEEN.Tween(n).to(kn.panelPoint.position,500).start().onComplete(function(){hn.src="",D=kn.panelPoint.position,new TWEEN.Tween(S.position).to({x:0,y:0,z:ln},1e3).easing(TWEEN.Easing.Exponential.InOut).start().onComplete(function(){rn.var=en,dn=!0,_=1})})}function g(n){var t=new THREE.Vector3;t.copy(D),D=t,dn=!1,_=.5,rn.var=0,new TWEEN.Tween(t).to(A.position,500).start().onComplete(function(){new TWEEN.Tween(S.position).to({x:0,y:0,z:ln+yn},1e3).easing(TWEEN.Easing.Exponential.InOut).start().onComplete(function(){hn.src=n,pn=!0,D=kn.videoPanel.position})})}function E(n){var t=$("#content-"+n),o=X[n],e=X[mn];dn=!1,un&&un.removeClass("active"),tn.tryToErase(-1,function(){tn.tryToType(bn[n],!1)}),rn.var=2*en,n!=mn&&(o.lastPos.copy(o.position),o.isContentActive=!0,K=o.material.color.getHexString(),new TWEEN.Tween(o.position).to({x:kn.contentPanel.position.x,y:-100,z:kn.contentPanel.position.z-50},1500).easing(TWEEN.Easing.Back.InOut).start(),e&&new TWEEN.Tween(e.position).to(e.lastPos,1500).easing(TWEEN.Easing.Back.InOut).start().onComplete(function(){e.isContentActive=!1})),new TWEEN.Tween(rn).to({var:an},1e3).easing(TWEEN.Easing.Back.InOut).start().onComplete(function(){new TWEEN.Tween(rn).to({var:en},500).easing(TWEEN.Easing.Cubic.Out).start().onComplete(function(){var o=new THREE.Vector3;o.copy(D),D=o,new TWEEN.Tween(o).to(kn.panelPoint.position,500).start().onComplete(function(){D=kn.panelPoint.position}),un=t,mn=n,un.addClass("active"),z(),dn=!0})})}function f(){on=!0,tn.tryToErase(-1,function(){tn.tryToType("Hi, I am Sergio Valderrama<br/>And I am a robot...",!0,function(){tn.tryToErase(7,function(){tn.tryToType(" wizard...",!0,function(){tn.tryToErase(12,function(){tn.tryToType("...<br/>Just look at my portfolio",!0,function(){setTimeout(function(){$(kn.console.element).animate({opacity:0},1e3,"swing"),$(kn.about.element).css("opacity","0"),$(kn.projects.element).css("opacity","0"),$(kn.skills.element).css("opacity","0"),$(kn.contact.element).css("opacity","0"),new TWEEN.Tween(S.position).to({x:0,y:0,z:ln},1e3).easing(TWEEN.Easing.Quintic.In).start().onComplete(function(){D=A.position,tn.captionEl.html(""),kn.console.position.set(0,-200,7e3),$(kn.console.element).animate({opacity:1},300,"swing"),$(kn.console.element).addClass("final-console"),$(kn.about.element).animate({opacity:1},300,"swing"),$(kn.projects.element).animate({opacity:1},300,"swing"),$(kn.skills.element).animate({opacity:1},300,"swing"),$(kn.contact.element).animate({opacity:1},300,"swing"),rn.var=en,tn.tryToType("Main menu",!1),dn=!0})},500)})})})})})})}function v(n){Q=.7*(n.clientX-Z.windowHalfX)*_,U=1.5*(n.clientY-Z.windowHalfY)*_}function y(n){return n*Math.PI/180}function b(n){return 180*n/Math.PI}function T(n){Z.width=window.innerWidth,Z.height=window.innerHeight,Z.windowHalfX=window.innerWidth/2,Z.windowHalfY=window.innerHeight/2,k(),I.setSize(window.innerWidth,window.innerHeight),N.setSize(window.innerWidth,window.innerHeight),S.aspect=window.innerWidth/window.innerHeight,S.updateProjectionMatrix()}function k(){Z.width/Z.height<1.7?(vn.addClass("active"),En=!0):(vn.removeClass("active"),En=!1)}function M(n,t,o){var e=document.createElement("div");e.innerHTML=n;var i=e.firstChild;return i.style.zIndex=1,i.style.width=t+"px",i.style.height=o+"px",$(i).removeClass("hidden"),new THREE.CSS3DObject(i)}function H(){$("#cursor").animate({opacity:0},"fast","swing").animate({opacity:1},"fast","swing")}function x(n,t,o,e){return[n+o*Math.cos(y(e)),t+o*Math.sin(y(e))]}function C(n){var t,o=!1;for(t=0;t<Y.length;t++)if(n.distanceTo(Y[t])<500){o=!0,nn++;break}return o}function R(n){var t,o,e,i;n!=wn&&(t=$("#project-"+wn),o=$("#project-"+n),e=$("#project-tab-"+wn),i=$("#project-tab-"+n),t&&e&&(t.removeClass("active"),e.removeClass("active").removeClass("dynamic-background").css({"background-color":""})),wn=n,o.addClass("active"),i.addClass("active").css({"background-color":"#"+K}))}function z(){$(".dynamic-color").css({color:"#"+K}),$(".dynamic-background").css({"background-color":"#"+K})}function P(n){var t,o,e=window.location.search.substring(1),i=e.split("&");for(t=0;t<i.length;t++)if(o=i[t].split("="),o[0]==n)return o[1]}function W(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}var j,I,L,N,S,D,A,O,B,q,V,G,F,X=[],Y=[],J=150,_=1,Q=0,U=0,K,Z={width:window.innerWidth,height:window.innerHeight,windowHalfX:window.innerWidth/2,windowHalfY:window.innerHeight/2},nn=0,tn,on=!1,en=.005,an=-.1,rn={var:0},sn=.01,cn=7e3,ln=7800,dn=!1,pn=!1,un=null,mn=-1,wn=-1,hn,gn=!1,En=!1,fn,vn,yn,bn=["About me","Projects","Skills","Contact"],Tn=[14033478,16671261,9667071,5885328,16752412,15589028,13430607],kn={console:null,contentPanel:null,panelPoint:null,about:null,projects:null,skills:null,contact:null,videoPanel:null};$(document).ready(function(){if(Detector.webgl)n(),o(),p(),a();else{var t=Detector.getWebGLErrorMessage();t.id="myCustomId",document.body.appendChild(t)}});var Mn=function(){this.captionEl=null,this.captionLength=0,this.consoleString="",this.consoleDeletionCounter=0,this.consoleDeletionNumber=0,this.callback=null,this.typingDelay=40,this.tryToType=function(n,t,o){var e=this;t?e.consoleString+=n:(e.captionLength=0,e.consoleString=n),e.callback=o,e.type()},this.tryToErase=function(n,t){var o=this;o.consoleDeletionNumber=-1==n?o.captionLength:n,o.callback=t,o.erase()},this.type=function(){var n=this;n.captionEl.html(n.consoleString.substr(0,n.captionLength++)),n.captionLength<n.consoleString.length+1?setTimeout(function(){n.type()},n.typingDelay):n.callback&&n.callback()},this.erase=function(){var n=this;n.captionEl.html(n.consoleString.substr(0,n.captionLength--)),n.captionLength>=0&&n.consoleDeletionCounter<n.consoleDeletionNumber?(setTimeout(function(){n.erase()},n.typingDelay),n.consoleDeletionCounter++):(n.consoleString=n.consoleString.substr(0,n.captionLength),n.consoleDeletionCounter=0,n.callback&&n.callback())}};